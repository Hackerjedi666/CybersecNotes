# Malware Analysis

## Some Cool Terms

- _Magic Numebers_: The first two hex digits of a file which atually indicats what type of the file that is. Eg. Every windows portable executable has a file signature of `4D 5A`
- _Strings_: Any sequence of encoded characters which occur within the executable files. Strings is litrally the name of the tool to see all the strings in an executable.
- _Program packers_: Used for the compression of the executable and one of the main uses of program packers is that it makes it harder for the reverse engineers to unpack the malware.
- Process Id : alwarys a multiple of 4 and used to identify a particular process.

## Malware exploitation Techniques

- Fileless techniques are mostly used in modern malware developement to avoid signature based techinques. These techniqes include directly using a shell code which creates a process in the memory itself rather than making a file and execting it.

- Dropper or Downloader is used for the delivery of the malwares and the whole point is to trick the user on clicking the on the link or the malware. A dropper is a stage one malware that is actually used to get the other malware type on the victim machine in a form of payload.

- Downloader is a piece of code that connects to the internet to retrieve additional tools after the initial infection by a dropper.

- A shellcode is a lightweight to run an exploit on the target.

## PE (Portable Executable) Format
    
It is the one of the main file format which is used by windows. 4D 5A is the magic bytes are the signature of every PE file.

# Static analysis

## Finger printing of the malware

There are particulari signatures like magic number or the hashes of the malware through which we can get a good overview of that particualr malware with the help of sites like _VirusTotal_.

For static analysis you can use debuggers like

- Pestudio
- Hxd
- `file` (command line tool)

## Strings

This is one of the most important part of static analysis. If we get lucky there are many things we can find in strings like urls, ips, dlls, libraries.

we can use the above debuggers for the strings or we can use command line tool like `strings` for these.

## Process Injection

Injecting the malware code in a trusted process.

Most injection techniques can be descirbed in six ways:

1. First the malware needs to get the handle on the process.

2. all of them have some type of data needs to injected

3. A way to transfer the data in the target process.

4. Injected code must be exectued.

The most common windows api call that is used in CREATE_PROCESS.

You can inject section only or the whole process itself. Some injection techniques are only specific to dlls.
